<div class="designer-dashboard__welcome">
  <div class="designer-dashboard__banner" style="background-image: url('<%= cl_image_path(@legal_entity.sound_designer.banner.key) if @legal_entity.sound_designer.banner.attached? %>')">
    <div class="designer-dashboard__banner-designer-photo">
      <div class="designer-dashboard__banner-photo-display">
        <% if @legal_entity.sound_designer.photo.attached? %>
          <%= cl_image_tag @legal_entity.sound_designer.photo.key, class: "pack-submission-form__image-placeholder" %>
        <% else %>
          <img src="https://res.cloudinary.com/dk9a86uhu/image/upload/v1753797330/sfx_shop/placeholder_dbrvpk.png" alt="image placeholder" class="pack-submission-form__image-placeholder">
        <% end %>
      </div>
    </div>
  </div>
</div>

<div class="designer-dashboard__container mt-3">
  <div class="designer-dashboard__user-profile">
    <div class="d-flex justify-content-between">
      <div class="d-flex">
        <p class="designer-dashboard__label me-3">Payout Information</p>
        <% if @payment_info.active? %>
          <div class="designer-dashboard__label">
            <i class="fas fa-check-circle approved-icon"></i>
          </div>
        <% end %>
      </div>
      <div class="d-flex justify-content-end mb-2">
        <% if @payment_info.pending_verif? %>
          <%= button_to "Activate", paypal_accept_path(@payment_info), method: "patch", class: "btn btn-admin-active me-2", data: { turbo_frame: "_top"} %>
        <% elsif @payment_info.active? %>
            <%= button_to "Deactivate", paypal_reject_path(@payment_info), method: "patch", class: "btn btn-reject me-2", data: { turbo_frame: "_top"} %>
        <% elsif @payment_info.inactive? %>
          <%= button_to "Re-activate", paypal_accept_path(@payment_info), method: "patch", class: "btn btn-admin-active me-2", data: { turbo_frame: "_top"} %>
        <% else %>
          <div class="btn btn-danger designer-dashboard__paypal-no-account">No Payment Infos</div>
        <% end %>
      </div>
    </div>
    <hr style="margin-top: 0">
    <% if @payment_info.paypal_account.present? %>
      <div>
        <div class="designer-dashboard__settings-grid mb-2">
          <span>Paypal Account:</span>
          <em><span class="info-color"><%= @payment_info.paypal_account %></span></em>
        </div>
        <div class="designer-dashboard__settings-grid">
          <span>Preferred Currency:</span>
          <span class="designer-dashboard__preferred-currency btn btn-admin"><%= @payment_info.preferred_currency.upcase %></span>
        </div>
        <hr>
        <div class="designer-dashboard__settings-grid">
          <span>Status:</span>
          <% if @payment_info.active? %>
            <span class="paypal-info-status btn btn-admin-active btn-hover-dismiss"><%= @payment_info.status.capitalize %></span>
          <% elsif @payment_info.pending_verif? %>
            <span class="paypal-info-status btn btn-orange btn-hover-dismiss">Pending</span>
          <% elsif @payment_info.inactive? %>
            <span class="paypal-info-status btn btn-rejected"><%= @payment_info.status.capitalize %></span>
          <% else %>
            <span class="paypal-info-status btn btn-light btn-hover-dismiss"><%= @payment_info.status.capitalize %></span>
          <% end %>
        </div>
      </div>
    <% elsif @payment_info.paypal_account.nil? || @payment_info_account.unknown? %>
      <p>No Paypal Account</p>
    <% end %>
  </div>
</div>

<div class="designer-dashboard__container mt-3">
  <div class="designer-dashboard__user-profile">
    <div class="d-flex justify-content-between">
      <div class="d-flex me-3">
        <div>
          <p class="designer-dashboard__label me-3">Legal Information</p>
        </div>
        <% if @legal_entity.accepted? %>
          <div class="designer-dashboard__label">
            <i class="fas fa-check-circle approved-icon"></i>
          </div>
        <% end %>
      </div>
      <div class="d-flex justify-content-end mb-2">
        <% if @legal_entity.pending? %>
          <div class="btn btn-admin designer-dashboard__paypal-pending">Pending Verification</div>
        <% elsif @legal_entity.incomplete? %>
          <div class="btn btn-warning designer-dashboard__paypal-inactive">Incomplete</div>
        <% elsif @legal_entity.rejected? %>
          <div class="btn btn-rejected designer-dashboard__paypal-no-account">Rejected</div>
        <% end %>
      </div>
    </div>
    <hr style="margin-top: 0">

    <div>
      <div class="designer-dashboard__settings-grid mb-2">
        <span>Email:</span>
        <div class="d-flex">
          <%= mail_to @legal_entity.user.email, @legal_entity.user.email, class: "info-color" %>
          <% if @legal_entity.user.confirmed? %>
            <div class="designer-dashboard__label ms-3">
              <i class="fas fa-check-circle approved-icon"></i>
            </div>
          <% elsif !@legal_entity.user.confirmation_sent_at.nil? && @legal_entity.user.confirmation_sent_at.to_date > 24.hours.ago.to_date %>
            <span class="btn btn-orange btn-hover-dismiss ms-3">Pending</span>
          <% else %>
            <%= link_to "Re-send Confirmation", resend_confirmation_path(@legal_entity.user), class: "btn btn-reject ms-3", data: { turbo_method: "POST" } %>
          <% end %>
        </div>
      </div>

      <div class="designer-dashboard__settings-grid mb-2">
        <span>Full legal name:</span>
        <em><span class="info-color"><%= @legal_entity.legal_name %></span></em>
      </div>

      <div class="designer-dashboard__settings-grid mb-2">
        <span>Artist name:</span>
        <em><span class="info-color"><%= @legal_entity.sound_designer.artist_name %></span></em>
      </div>

      <% if @legal_entity.company_name? %>        
        <div class="designer-dashboard__settings-grid mb-2">
          <span>Company:</span>
          <em><span class="info-color"><%= @legal_entity.company_name %></span></em>
      </div>
      <% end %>

      <div class="designer-dashboard__settings-grid mb-2">
        <span>Address:</span>
        <em><pre class="info-color"><%= @legal_entity.address %></pre></em>
      </div>
      <%= link_to "See profile page", sound_designer_path(@legal_entity.sound_designer), class: "btn btn-light text-dark" %>
      <hr>
      <div class="designer-dashboard__settings-grid mb-2">
        <span>Submitted on:</span>
        <em><span class="info-color"><%= @legal_entity.created_at.strftime("%B %d, %Y") %></span></em>
      </div>
      <div class="designer-dashboard__settings-grid mb-2">
        <span>Validity:</span>
        <div>
          <span class="info-color btn btn-hover-dismiss <%= @legal_entity.valid? ? 'btn-admin-active' : 'btn-warning' %>"><%= @legal_entity.valid? ? "Valid" : "Invalid" %></span>
        </div>
      </div>
      <% unless @legal_entity.accepted? || @legal_entity.rejected? %>
        <hr>
        <div class="d-flex">
          <%= button_to legal_entity_accept_path(@legal_entity), class: "submission-card_btn-group submission-card__confirm-accept", method: "patch" do %>
            <div >
              <i class="fas fa-check"></i>
            </div>
          <% end %>
          <%= button_to legal_entity_reject_path(@legal_entity), method: "patch", data: { turbo_confirm: "Are ou sure?" }, class: "submission-card_btn-group submission-card__confirm-reject" do %>
            <div>
              <i class="fas fa-ban"></i>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
</div>
<% if @legal_entity.accepted? %>
  <div><%= button_to "Deactivate", legal_entity_reject_path(@legal_entity),method: "patch", data: { turbo_confirm: "Are ou sure?" }, class: "btn btn-reject w-100 mt-3" %></div>
<% elsif @legal_entity.rejected? %>
  <div><%= button_to "Re-activate", legal_entity_accept_path(@legal_entity),method: "patch", data: { turbo_confirm: "Are ou sure?" }, class: "btn btn-admin-active w-100 mt-3" %></div>
<% end %>